{"ast":null,"code":"import _toConsumableArray from \"D:\\\\work\\\\aa\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\n\nvar updateCartItems = function updateCartItems(cartItems, item, idx) {\n  if (item.count === 0) {\n    return [].concat(_toConsumableArray(cartItems.slice(0, idx)), _toConsumableArray(cartItems.slice(idx + 1)));\n  }\n\n  if (idx === -1) {\n    return [].concat(_toConsumableArray(cartItems), [item]);\n  }\n\n  return [].concat(_toConsumableArray(cartItems.slice(0, idx)), [item], _toConsumableArray(cartItems.slice(idx + 1)));\n};\n\nvar updateCartItem = function updateCartItem(book) {\n  var item = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var quantity = arguments.length > 2 ? arguments[2] : undefined;\n\n  var _item$_id = item._id,\n      _id = _item$_id === void 0 ? book._id : _item$_id,\n      _item$count = item.count,\n      count = _item$count === void 0 ? 0 : _item$count,\n      _item$title = item.title,\n      title = _item$title === void 0 ? book.title : _item$title,\n      _item$total = item.total,\n      total = _item$total === void 0 ? 1 : _item$total;\n\n  return {\n    _id: _id,\n    title: title,\n    count: count + quantity,\n    total: total + quantity * book.price\n  };\n};\n\nvar updateOrder = function updateOrder(state, bookId, quantity) {\n  var books = state.bookList.books,\n      cartItems = state.shoppingCart.cartItems;\n  var book = books.find(function (_ref) {\n    var _id = _ref._id;\n    return _id === bookId;\n  });\n  var itemIndex = cartItems.findIndex(function (_ref2) {\n    var _id = _ref2._id;\n    return _id === bookId;\n  });\n  var item = cartItems[itemIndex];\n  var newItem = updateCartItem(book, item, quantity);\n  var total = cartItems.reduce(function (prev, cur) {\n    return prev + cur.price;\n  }, 0);\n  console.log(total);\n  return {\n    orderTotal: total,\n    cartItems: updateCartItems(cartItems, newItem, itemIndex)\n  };\n};\n\nvar updateShoppingCart = function updateShoppingCart(state, action) {\n  if (state === undefined) {\n    return {\n      cartItems: [],\n      orderTotal: 0\n    };\n  }\n\n  switch (action.type) {\n    case 'BOOK_ADDED_TO_CART':\n      return updateOrder(state, action.payload, 1);\n\n    case 'BOOK_REMOVED_FROM_CART':\n      return updateOrder(state, action.payload, -1);\n\n    case 'ALL_BOOKS_REMOVED_FROM_CART':\n      var item = state.shoppingCart.cartItems.find(function (_ref3) {\n        var _id = _ref3._id;\n        return _id === action.payload;\n      });\n      return updateOrder(state, action.payload, -item.count);\n\n    default:\n      return state.shoppingCart;\n  }\n};\n\nexport default updateShoppingCart;","map":{"version":3,"sources":["D:/work/aa/client/src/reducers/shopping-cart.js"],"names":["updateCartItems","cartItems","item","idx","count","slice","updateCartItem","book","quantity","_id","title","total","price","updateOrder","state","bookId","books","bookList","shoppingCart","find","itemIndex","findIndex","newItem","reduce","prev","cur","console","log","orderTotal","updateShoppingCart","action","undefined","type","payload"],"mappings":"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","sourcesContent":["const updateCartItems = (cartItems, item, idx) => {\n\n  if (item.count === 0) {\n    return [\n      ...cartItems.slice(0, idx),\n      ...cartItems.slice(idx + 1)\n    ];\n  }\n\n  if (idx === -1) {\n    return [\n      ...cartItems,\n      item\n    ];\n  }\n\n  return [\n    ...cartItems.slice(0, idx),\n    item,\n    ...cartItems.slice(idx + 1)\n  ];\n};\n\nconst updateCartItem = (book, item = {}, quantity) => {\n\n  const {\n    _id = book._id,\n    count = 0,\n    title = book.title,\n    total = 1\n  } = item;\n\n  return {\n    _id,\n    title,\n    count: count  + quantity,\n    total: total + quantity*book.price\n  };\n};\n\nconst updateOrder = (state, bookId, quantity) => {\n  const { bookList: { books }, shoppingCart: { cartItems }} = state;\n\n  const book = books.find(({_id}) => _id === bookId);\n  const itemIndex = cartItems.findIndex(({_id}) => _id === bookId);\n  const item = cartItems[itemIndex];\n\n  const newItem = updateCartItem(book, item, quantity);\n  const total = cartItems.reduce(function (prev, cur) {\n    return prev + cur.price\n  }, 0)\n  console.log(total)\n  return {\n    orderTotal: total,\n    cartItems: updateCartItems(cartItems, newItem, itemIndex)\n  };\n};\n\nconst updateShoppingCart = (state, action) => {\n\n  if (state === undefined) {\n    return {\n      cartItems: [],\n      orderTotal: 0\n    }\n  }\n\n  switch(action.type) {\n    case 'BOOK_ADDED_TO_CART':\n      return updateOrder(state, action.payload, 1);\n\n    case 'BOOK_REMOVED_FROM_CART':\n      return updateOrder(state, action.payload, -1);\n\n    case 'ALL_BOOKS_REMOVED_FROM_CART':\n      const item = state.shoppingCart.cartItems.find(({_id}) => _id === action.payload);\n      return updateOrder(state, action.payload, -item.count);\n\n    default:\n      return state.shoppingCart;\n  }\n};\n\nexport default updateShoppingCart;\n"]},"metadata":{},"sourceType":"module"}