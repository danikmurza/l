{"ast":null,"code":"import _toConsumableArray from \"D:\\\\work\\\\130-thunk\\\\130-thunk\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\n\nvar updateCartItems = function updateCartItems(cartItems, item, idx) {\n  if (item.count === 0) {\n    return [].concat(_toConsumableArray(cartItems.slice(0, idx)), _toConsumableArray(cartItems.slice(idx + 1)));\n  }\n\n  if (idx === -1) {\n    return [].concat(_toConsumableArray(cartItems), [item]);\n  }\n\n  return [].concat(_toConsumableArray(cartItems.slice(0, idx)), [item], _toConsumableArray(cartItems.slice(idx + 1)));\n};\n\nvar updateCartItem = function updateCartItem(book) {\n  var item = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var quantity = arguments.length > 2 ? arguments[2] : undefined;\n  var _item$id = item.id,\n      id = _item$id === void 0 ? book.id : _item$id,\n      _item$count = item.count,\n      count = _item$count === void 0 ? 0 : _item$count,\n      _item$title = item.title,\n      title = _item$title === void 0 ? book.title : _item$title,\n      _item$total = item.total,\n      total = _item$total === void 0 ? 0 : _item$total;\n  return {\n    id: id,\n    title: title,\n    count: count + quantity,\n    total: total + quantity * book.price\n  };\n};\n\nvar updateOrder = function updateOrder(state, bookId, quantity) {\n  var books = state.bookList.books,\n      cartItems = state.shoppingCart.cartItems,\n      products = state.newsList.products;\n  var book = books.find(function (_ref) {\n    var id = _ref.id;\n    return id === bookId;\n  });\n  var itemIndex = cartItems.findIndex(function (_ref2) {\n    var id = _ref2.id;\n    return id === bookId;\n  });\n  var item = cartItems[itemIndex];\n  var newItem = updateCartItem(book, item, quantity);\n  return {\n    orderTotal: 0,\n    cartItems: updateCartItems(cartItems, newItem, itemIndex),\n    products: products\n  };\n};\n\nvar updateShoppingCart = function updateShoppingCart(state, action) {\n  if (state === undefined) {\n    return {\n      cartItems: [],\n      orderTotal: 0\n    };\n  }\n\n  switch (action.type) {\n    case 'BOOK_ADDED_TO_CART':\n      return updateOrder(state, action.payload, 1);\n\n    case 'BOOK_REMOVED_FROM_CART':\n      return updateOrder(state, action.payload, -1);\n\n    case 'ALL_BOOKS_REMOVED_FROM_CART':\n      var item = state.shoppingCart.cartItems.find(function (_ref3) {\n        var id = _ref3.id;\n        return id === action.payload;\n      });\n      return updateOrder(state, action.payload, -item.count);\n\n    default:\n      return state.shoppingCart;\n  }\n};\n\nexport default updateShoppingCart;","map":{"version":3,"sources":["D:/work/130-thunk/130-thunk/src/reducers/shopping-cart.js"],"names":["updateCartItems","cartItems","item","idx","count","slice","updateCartItem","book","quantity","id","title","total","price","updateOrder","state","bookId","books","bookList","shoppingCart","products","newsList","find","itemIndex","findIndex","newItem","orderTotal","updateShoppingCart","action","undefined","type","payload"],"mappings":"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","sourcesContent":["const updateCartItems = (cartItems, item, idx) => {\n\n  if (item.count === 0) {\n    return [\n      ...cartItems.slice(0, idx),\n      ...cartItems.slice(idx + 1)\n    ];\n  }\n\n  if (idx === -1) {\n    return [\n      ...cartItems,\n      item\n    ];\n  }\n\n  return [\n    ...cartItems.slice(0, idx),\n    item,\n    ...cartItems.slice(idx + 1)\n  ];\n};\n\nconst updateCartItem = (book, item = {}, quantity) => {\n\n  const {\n    id = book.id,\n    count = 0,\n    title = book.title,\n    total = 0 } = item;\n\n  return {\n    id,\n    title,\n    count: count + quantity,\n    total: total + quantity*book.price\n  };\n};\n\nconst updateOrder = (state, bookId, quantity) => {\n  const { bookList: { books }, shoppingCart: { cartItems }, newsList: { products }} = state;\n\n  const book = books.find(({id}) => id === bookId);\n  const itemIndex = cartItems.findIndex(({id}) => id === bookId);\n  const item = cartItems[itemIndex];\n\n  const newItem = updateCartItem(book, item, quantity);\n  return {\n    orderTotal: 0,\n    cartItems: updateCartItems(cartItems, newItem, itemIndex),\n    products: products\n  };\n};\n\nconst updateShoppingCart = (state, action) => {\n\n  if (state === undefined) {\n    return {\n      cartItems: [],\n      orderTotal: 0\n    }\n  }\n\n  switch(action.type) {\n    case 'BOOK_ADDED_TO_CART':\n      return updateOrder(state, action.payload, 1);\n\n    case 'BOOK_REMOVED_FROM_CART':\n      return updateOrder(state, action.payload, -1);\n\n    case 'ALL_BOOKS_REMOVED_FROM_CART':\n      const item = state.shoppingCart.cartItems.find(({id}) => id === action.payload);\n      return updateOrder(state, action.payload, -item.count);\n\n    default:\n      return state.shoppingCart;\n  }\n};\n\nexport default updateShoppingCart;\n"]},"metadata":{},"sourceType":"module"}